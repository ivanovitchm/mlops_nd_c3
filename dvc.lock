schema: '2.0'
stages:
  preprocess:
    cmd: python pipeline/preprocess/run.py --input_artifact_name pipeline/data/census.csv
      --output_artifact_name pipeline/data/preprocessing_data.csv
    deps:
    - path: pipeline/data/census.csv
      md5: 145de00f6e6053d3f7044628f9a5b5ff
      size: 3974474
    - path: pipeline/preprocess/run.py
      md5: e3b6a0b55e21a6647c04b1a51a259701
      size: 2428
    outs:
    - path: pipeline/data/preprocessing_data.csv
      md5: 4309856f7edb21206b5193724ff484b0
      size: 3515984
  datacheck:
    cmd: pytest pipeline/check_data -s -vv --sample_artifact pipeline/data/preprocessing_data.csv
      --param params.yaml
    deps:
    - path: pipeline/check_data/conftest.py
      md5: cf5c36dedec8f18fddc9294d1b29a240
      size: 1269
    - path: pipeline/check_data/test_data.py
      md5: 274655585642e55ba840d0d59e830d7b
      size: 4049
    - path: pipeline/data/preprocessing_data.csv
      md5: 4309856f7edb21206b5193724ff484b0
      size: 3515984
    params:
      params.yaml:
        data.ks_alpha: 0.05
        data.reference_dataset: pipeline/data/preprocessing_data.csv
  segregate:
    cmd: python pipeline/segregate/run.py --input_artifact pipeline/data/preprocessing_data.csv
      --param params.yaml
    deps:
    - path: pipeline/data/preprocessing_data.csv
      md5: 4309856f7edb21206b5193724ff484b0
      size: 3515984
    - path: pipeline/segregate/run.py
      md5: 9e3a0ba0757148d65dda03fa6587d7a2
      size: 2489
    params:
      params.yaml:
        data.stratify: salary
        data.test_size: 0.3
        main.random_seed: 42
    outs:
    - path: pipeline/data/test_data.csv
      md5: 63879402361c93a2ef2589ffb0f3f0bc
      size: 1054435
    - path: pipeline/data/train_data.csv
      md5: 41bf494a1a72935d10542c743ce8b06a
      size: 2461705
  train:
    cmd: python pipeline/train/run.py --train_data pipeline/data/train_data.csv --param
      params.yaml --score_file pipeline/data/train_scores.json
    deps:
    - path: pipeline/data/train_data.csv
      md5: 41bf494a1a72935d10542c743ce8b06a
      size: 2461705
    - path: pipeline/train/helper.py
      md5: e30a63a41fa3f4ef6b7b76c9243961e0
      size: 4313
    - path: pipeline/train/run.py
      md5: 8a2980e3b7f0b3ac8ef1d38bc4b9e9af
      size: 5091
    - path: pipeline/train/transformer_feature.py
      md5: 1017f38d013bb96012a7baf51c819086
      size: 4554
    params:
      params.yaml:
        data.stratify: salary
        data.val_size: 0.3
        main.random_seed: 42
        train.export_artifact: pipeline/data/model_export
    outs:
    - path: pipeline/data/encoder_export
      md5: c84ed6bd7e06ea14739c62ef12d16aa8
      size: 503
    - path: pipeline/data/model_export
      md5: b6c477a957c5ba7ab8e4e1c94a4729b0
      size: 77473
    - path: pipeline/data/train_scores.json
      md5: 9243a706b023936425a8d0c927d7428e
      size: 139
  evaluate:
    cmd: python pipeline/evaluate/run.py --test_data pipeline/data/test_data.csv --model
      pipeline/data/model_export --encoder pipeline/data/encoder_export --score_file
      pipeline/data/test_scores.json --slice_file pipeline/data/slice_output.json
    deps:
    - path: pipeline/data/encoder_export
      md5: c84ed6bd7e06ea14739c62ef12d16aa8
      size: 503
    - path: pipeline/data/model_export
      md5: b6c477a957c5ba7ab8e4e1c94a4729b0
      size: 77473
    - path: pipeline/data/test_data.csv
      md5: 63879402361c93a2ef2589ffb0f3f0bc
      size: 1054435
    - path: pipeline/evaluate/run.py
      md5: 849529e2a95f5c745c7b683623d60e9c
      size: 4244
    - path: pipeline/train/helper.py
      md5: e30a63a41fa3f4ef6b7b76c9243961e0
      size: 4313
    - path: pipeline/train/transformer_feature.py
      md5: 1017f38d013bb96012a7baf51c819086
      size: 4554
    outs:
    - path: pipeline/data/slice_output.json
      md5: 8d1d4a30473989fd5321eb8eb9ea29d8
      size: 20802
    - path: pipeline/data/test_scores.json
      md5: 9b091b44b8d28fee4b360350d7864b3f
      size: 138
  check_model:
    cmd: pytest pipeline/check_model -s -vv --test_data pipeline/data/test_data.csv
      --model pipeline/data/model_export --encoder pipeline/data/encoder_export
    deps:
    - path: pipeline/check_model/conftest.py
      md5: 5b0828906c0c5dd462da38375121922c
      size: 1456
    - path: pipeline/check_model/test_model.py
      md5: eee32bbd520975b2aca4ef3990c000f9
      size: 961
    - path: pipeline/data/encoder_export
      md5: c84ed6bd7e06ea14739c62ef12d16aa8
      size: 503
    - path: pipeline/data/model_export
      md5: b6c477a957c5ba7ab8e4e1c94a4729b0
      size: 77473
    - path: pipeline/data/test_data.csv
      md5: 63879402361c93a2ef2589ffb0f3f0bc
      size: 1054435
    - path: pipeline/train/transformer_feature.py
      md5: 1017f38d013bb96012a7baf51c819086
      size: 4554
